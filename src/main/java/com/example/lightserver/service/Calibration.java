package com.example.lightserver.service;

import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Service;

@Service
@Slf4j
public class Calibration {
    public double getTriY(int id, int r, int g, int b, int c) { // 삼자극치 Y == 조도
        switch (id) {
            case 1:
//                return -0.279092984 + r * 0.061654097 + g * 0.161100176 + b * (-0.029059113);
                // 2023.11.28 센서 1번 재보정
                return -27.9383802749026 + r * 9.97359956517132 + g * (4.24991246172828) + b * 3.0641692788236 + c * (-66.7845340468781);
            case 2:
//                return -0.298626322 + r * 0.05836012 + g * 0.163846657 + b * (-0.027835675);
                // 2023.11.28 센서 2번 재보정
                return -249.176511726997 + r * 5.44278453739663 + g * (-31.1118856245206) + b * 36.390039622871+ c * 90.3646714084891;
            case 3:
//                return -0.221772775 + r * 0.056878566 + g * 0.158382467 + b * (-0.023548041);
                // 2023.11.23 센서 3번 재보정
                return -103.44105028456 + r * 12.697364649088 + g * (-24.0603130364362) + b * 25.8364949859762 + c * 43.5909259048591;
            case 4:
                return -0.16430792 + r * 0.063095764 + g * 0.160295708 + b * (-0.021687505);
            case 5:
//                return -0.38918913 + r * 0.058935596 + g * 0.162401518 + b * (-0.027476641);
                // 2023.11.29 센서 5번 재보정
                return -18.8795779826715 + r * 3.91172544852145 + g * 2.24643485989109 + b * (-1.60432700125447) + c * (-13.8447044733382);
            case 6:
                return -0.246702845 + r * 0.055949055 + g * 0.16757628 + b * (-0.033882516);
            case 7:
                return -0.524427825 + r * 0.062731508 + g * 0.154131538 + b * (-0.020061495);
            case 8:
                return -0.508242904 + r * 0.061345528 + g * 0.152840325 + b * (-0.016371799);
            case 9:
                return -0.104275138 + r * 0.057407496 + g * 0.162521395 + b * (-0.025568323);

        }
        return 0;
    }


    public  double getTriX(int id, int r, int g, int b, int c) {
        switch (id) {
            case 1:
//                return -0.540033472 + r * 0.130464893 + g * 0.078893784 + b * 0.029335389;
                // 2023.11.28 센서 1번 재보정
                return -25.9376735409305 + r * 9.26628288181306 + g * (3.81962355028635) + b * 2.72266718327045 + c * (-61.0445302881096);
            case 2:
//                return -0.575092428 + r * 0.123271456 + g * 0.079547052 + b * 0.032455042;
                // 2023.11.28 센서 2번 재보정
                return -222.086827592713 + r * 5.16500469078589 + g * (-28.9488952613521) + b * 33.3034545759475+ c * 85.1111075209404;
            case 3:
                // 2023.11.23 센서 3번 재보정
                return -98.1447459548326 + r * 11.7556771092025 + g * (-22.0792905204475) + b * 23.4841052989703 + c * 40.1978486580642;
//                return -0.324803165 + r * 0.118093792 + g * 0.07823233 + b * 0.032888966;

            case 4:
                return -0.28096381 + r * 0.130414637 + g * 0.075902137 + b * 0.039594168;
            case 5:
//                return -0.633737209 + r * 0.123067303 + g * 0.081651477 + b * 0.028675858;
                // 2023.11.29 센서 5번 재보정
                return -18.097846018591 + r * 4.06630760900976 + g * 1.67911429583252 + b * (-1.26863203556854) + c * (-12.9215453416184);
            case 6:
                return -0.57456887 + r * 0.118958246 + g * 0.086940139 + b * 0.022386588;
            case 7:
                return -0.869105866 + r * 0.130183542 + g * 0.073675039 + b * 0.036632388;
            case 8:
                return -0.785511404 + r * 0.124448107 + g * 0.071446505 + b * 0.042158064;
            case 9:
                return -0.415970471 + r * 0.121443155 + g * 0.079931136 + b * 0.031209955;

        }
        return 0;
    }

    public  double getTriZ(int id, int r, int g, int b, int c) {
        switch (id) {
            case 1:
//                return -0.169093724 + r * (-0.015753723) + g * 0.022402746 + b * 0.325903455;
                // 2023.11.28 센서 1번 재보정
                return -29.5568755132454 + r * 9.79819725709018 + g * (-1.44860615762319) + b * 10.7009931823253 + c * (-54.0746772532912);
            case 2:
//                return -0.287808745 + r * (-0.012143219) + g * 0.01699743 + b * 0.34384724;
                // 2023.11.28 센서 2번 재보정
                return -227.297894701736 + r * 4.43573483315544 + g * (-26.2879289943448) + b * 33.8496593526502+ c * 66.3241015626998;
            case 3:
                // 2023.11.23 센서 3번 재보정
//                return -0.02029488 + r * (-0.013353969) + g * 0.020696496 + b * 0.33751459;
                return -56.5787635099205 + r * 11.4536729354266 + g * (-22.8942702174448) + b * 26.8214106429133 + c * 34.0673528680515;
            case 4:
                return -0.056875789 + r * (-0.013156724) + g * 0.017156471 + b * 0.357163819;
            case 5:
//                return 0.036094746 + r * (-0.014357302) + g * 0.021125084 + b * 0.336536356;
                // 2023.11.29 센서 5번 재보정
                return -12.3078327829357 + r * 3.50043004611007 + g * (-1.17287588676182) + b * (4.22161761487567) + c * (-10.5186604565002);
            case 6:
                return -0.029516061 + r * (-0.013936281) + g * 0.021163117 + b * 0.339874629;
            case 7:
                return -0.099110836 + r * (-0.011766579) + g * 0.013851022 + b * 0.340957969;
            case 8:
                return -0.331990358 + r * (-0.01069218) + g * 0.014445812 + b * 0.347027302;
            case 9:
                return -0.052460977 + r * (-0.0159319) + g * 0.024790711 + b * 0.328395022;

        }
        return 0;
    }

    public double getCct(int id, int r, int g, int b, int c) {
        double x = getTriX(id, r, g, b, c);
        double y = getTriY(id, r, g, b, c);
        double z = getTriZ(id, r, g, b, c);
        double X = x / (x + y + z);
        double Y = y / (x + y + z);
        double n = (X - 0.332) / (Y - 0.1858);
        double cct = -437 * n * n * n + 3607 * n * n - 6861 * n + 5514.31;
        return cct;
    }
}
